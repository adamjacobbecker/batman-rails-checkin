!!!
%html
  %head
    %meta{:charset => "utf-8"}
      %title{"data-bind" => "window.BatmanRailsCheckin.pageTitle"}
      :javascript
        var bootstrapData = #{@user_json}
      = stylesheet_link_tag 'application'
      = javascript_include_tag "application"
      = csrf_meta_tags
  %body
    .navbar.navbar-fixed-top
      .navbar-inner
        .container
          %a.brand{"data-route" => "'/'"}
            Batman Rails Checkin
          .nav-collapse
            %ul.nav{data: {showif: "window.BatmanRailsCheckin.currentUser"}}
              %li{:data => {"foreach-navproject" => "window.BatmanRailsCheckin.Project.all", |
                  "addclass-active" => "window.BatmanRailsCheckin.currentProjectId | equals navproject.id"}}
                %a{:data => {"bind" => "navproject.name", "route" => "routes.projects[navproject].users"}}

              %li{"data-hideif" => "controllers.base.isAddingProject"}
                %a{"data-event-click" => "controllers.base.toggleIsAddingProject"} New Project...

              %li.new-project-li{"data-showif" => "controllers.base.isAddingProject", "data-view" => "AddProjectFormView", |
                                 style: "display: none;"}
                %form{"accept-charset" => "UTF-8", "data-event-submit" => "controllers.base.createProject", "data-formfor-project" => "controllers.base.newProject"}
                  %input.span2{type: "text", placeholder: "Project name", "data-bind" => "project.name", name: "project[:name]"}
                  %button.btn.btn-success Create Project
                  %a.btn{"data-event-click" => "controllers.base.toggleIsAddingProject"} &nbsp;&times;&nbsp;

            %ul.nav.pull-right{data: {showif: "window.BatmanRailsCheckin.currentUser"}}
              %li
                %a{:data => {bind: "window.BatmanRailsCheckin.currentUser.name | prepend 'logout '", |
                            "route" => "routes.logout"}}
    #main.container
      .content
        %p#flashnotice.alert.alert-overlay.alert-success{:data => {"showif" => "window.BatmanRailsCheckin.flash.success.length"}}
          %a.close{:href => "#", :onclick => "$('#flashnotice').hide(); return false"} Ã—
          %span{:data => {"bind" => "window.BatmanRailsCheckin.flash.success"}}
        %p#flashwarning.alert.alert-overlay.alert-error{:data => {"showif" => "window.BatmanRailsCheckin.flash.error.length"}}
          %a.close{:href => "#", :onclick => "$('#flashwarning').hide(); return false"} Ã—
          %span{:data => {"bind" => "window.BatmanRailsCheckin.flash.error"}}
        %div{:data => {"yield" => "main"}}
